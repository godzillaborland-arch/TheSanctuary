<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Sanctuary ‚Äî Wisdom Wall</title>
  <meta name="description" content="A living wall of meditation reflections from The Sanctuary community." />

  <!-- Plausible -->
  <script defer data-domain="godzillaborland-arch.github.io" src="https://plausible.io/js/script.js"></script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
    body{font-family:'Inter',sans-serif;background-color:#f7f3ff;color:#1f2937;}
    .gradient-bg{background:linear-gradient(135deg,#6b46c1,#7c3aed,#a78bfa);background-size:300% 300%;animation:gradientShift 10s ease infinite;}
    @keyframes gradientShift{0%,100%{background-position:left top;}50%{background-position:right bottom;}}
    .word-container{position:relative;width:100%;max-width:1100px;height:70vh;margin:0 auto;overflow:hidden;}
    .word{position:absolute;font-weight:600;color:rgba(75,0,130,.85);text-shadow:0 1px 3px rgba(0,0,0,.1);white-space:nowrap;animation:float 8s ease-in-out infinite;user-select:none;}
    @keyframes float{0%,100%{transform:translateY(0) rotate(0deg);opacity:1;}50%{transform:translateY(-18px) rotate(2deg);opacity:.92;}}
    .fade-in{animation:fadeIn .9s ease forwards;}
    @keyframes fadeIn{from{opacity:0;transform:scale(.98);}to{opacity:1;transform:scale(1);}}
  </style>
</head>
<body>
  <header class="gradient-bg text-white py-10 rounded-b-3xl shadow-lg mb-4 text-center">
    <h1 class="text-3xl md:text-4xl font-extrabold mb-2">The Wisdom Wall</h1>
    <p class="text-indigo-100 text-base">Reflections from fellow travelers on the path üïäÔ∏è</p>
  </header>

  <main class="px-4">
    <div id="word-cloud" class="word-container">
      <p class="text-gray-400 text-sm fade-in absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2">
        Loading reflections...
      </p>
    </div>

    <div class="max-w-4xl mx-auto text-center mt-4">
      <a href="submit.html" class="inline-block px-6 py-3 rounded-lg bg-cyan-500 text-white font-semibold hover:bg-cyan-600 transition">Share Your Wisdom</a>
      <a href="index.html" class="ml-3 inline-block text-indigo-600 hover:underline">Back to Sanctuary</a>
    </div>
  </main>

  <footer class="text-center text-xs text-slate-400 mt-6 mb-6">
    ¬© <span id="year"></span> Sundar Rajan
  </footer>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCTwIvONkXFsUsnn7GZxVG9x0RYCcB1xSw",
      authDomain: "quantumviewpoint.firebaseapp.com",
      projectId: "quantumviewpoint",
      storageBucket: "quantumviewpoint.firebasestorage.app",
      messagingSenderId: "1081460817095",
      appId: "1:1081460817095:web:e59f6e67da956201ec52e2",
      measurementId: "G-FSEE5PY6S7"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    document.addEventListener('DOMContentLoaded', () => {
      if (window.plausible) plausible('Viewed Wisdom Wall');
    });

    const container = document.getElementById('word-cloud');
    function renderCloud(docs){
      const w = container.clientWidth, h = container.clientHeight;
      container.innerHTML = '';
      docs.forEach(d => {
        const t = d.measure || '‚Äî';
        const el = document.createElement('span');
        el.textContent = t;
        el.className = 'word fade-in';
        const x = Math.random() * (w - 150);
        const y = Math.random() * (h - 60);
        const fs = 16 + Math.random() * 32; // 16‚Äì48px
        const dur = 6 + Math.random() * 8;
        el.style.left = `${x}px`;
        el.style.top = `${y}px`;
        el.style.fontSize = `${fs}px`;
        el.style.animationDuration = `${dur}s`;
        el.style.color = `hsl(${250 + Math.random()*30}, 70%, ${48 + Math.random()*22}%)`;
        container.appendChild(el);
      });
    }

    // TEMP: show all entries (switch to where('approved','==',true) later)
    db.collection('meditation_measures')
      .orderBy('timestamp','desc')
      .limit(60)
      .onSnapshot(snap => {
        if (snap.empty) {
          container.innerHTML = '<p class="text-gray-500 text-center">No reflections yet üå±</p>';
          return;
        }
        renderCloud(snap.docs.map(d => d.data()));
      });

    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
